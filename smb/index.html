<!DOCTYPE html>
<html>
	<head>
		<title>Super Mario Bros.</title>
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script type="text/javascript" src="./constant.js"></script>
        <link rel="icon" type="image/x-icon" href="../favicon.ico">
	</head>
	<body>
        <button id ="start">Start</button>

        <script>
            document.getElementById('start').addEventListener('click', (event) => {
                let hash = window.location.hash.slice(1)
                let parts = hash.split("/").filter(p=>p);
                let pageId = parts[0] || "yAXhWaGh";

                // Load the JSON file containing all paragraphs
                fetch(`smb.json`)
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Network response was not ok: ' + response.statusText);
                        }
                        return response.json();
                    })
                    .then(jsonData => {
                        const data = jsonData[pageId];

                        if (!data) {
                            throw new Error(`No data found for id: ${pageId}`);
                        }
                        
                        window.parent.postMessage({ type: "message",  action: "start", id: pageId }, "*");
                        new Enjine.Application().Initialize(new Mario.LoadingState(data, pageId), THE_WIDTH, THE_HEIGHT);
                        event.target.remove(); // removes the clicked button
                    })
                    .catch(error => {
                        console.log('Error loading level data: ' + error);
                    });

            })
        </script>
        <style>
            button {
            margin: 5px;
            display: block;
            background: #4ccd5a;
            border: 1px solid #4ccd5a;
            padding: 0.5rem 1rem;
            font-weight: 600;
            font-size: 1rem;
            }

            button:hover {
            background: #3ca448;
            }

            button:active {
            transform: scale(0.9);
            }
        </style>

        
    
		<canvas id="canvas" width="640" height="480">
			<p>Your browser does not support the canvas element.</p>
		</canvas>

        <!-- Enjine Includes -->
        <script src="Enjine/core.js"></script>
        <script src="Enjine/gameCanvas.js"></script>
        <script src="Enjine/keyboardInput.js"></script>
        <script src="Enjine/resources.js"></script>
        <script src="Enjine/drawable.js"></script>
        <script src="Enjine/state.js"></script>
        <script src="Enjine/gameTimer.js"></script>
        <script src="Enjine/camera.js"></script>
        <script src="Enjine/drawableManager.js"></script>
        <script src="Enjine/sprite.js"></script>
        <script src="Enjine/spriteFont.js"></script>
        <script src="Enjine/frameSprite.js"></script>
        <script src="Enjine/animatedSprite.js"></script>
        <script src="Enjine/collideable.js"></script>
        <script src="Enjine/application.js"></script>
        <script src="code/storage.js"></script>


        <!-- Actual game code -->
        <script src="code/setup.js"></script>
        <script src="code/spriteCuts.js"></script>
        <script src="code/level.js"></script>
        <script src="code/backgroundGenerator.js"></script>
        <script src="code/backgroundRenderer.js"></script>
        <script src="code/improvedNoise.js"></script>
        <script src="code/notchSprite.js"></script>
        <script src="code/character.js"></script>
        <script src="code/levelRenderer.js"></script>
        <script src="code/levelGenerator.js"></script>
        <script src="code/spriteTemplate.js"></script>
        <script src="code/enemy.js"></script>
        <script src="code/fireball.js"></script>
        <script src="code/sparkle.js"></script>
        <script src="code/coinAnim.js"></script>
        <script src="code/mushroom.js"></script>
		<script src="code/particle.js"></script>
		<script src="code/fireFlower.js"></script>
        <script src="code/bulletBill.js"></script>
        <script src="code/flowerEnemy.js"></script>
        <script src="code/shell.js"></script>

        <script src="code/titleState.js"></script>
        <script src="code/loadingState.js"></script>
        <script src="code/loseState.js"></script>
        <script src="code/winState.js"></script>
        <script src="code/mapState.js"></script>
        <script src="code/levelState.js"></script>

        <script src="code/music.js"></script>

        
</body>
</html>
